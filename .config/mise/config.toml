# mise.toml - Comprehensive Development Environment Configuration
# ==============================================================================
# SETTINGS
# ==============================================================================
[settings]
# UV Package Manager Integration
python.uv_venv_auto = true
python.compile = false
pipx.uvx = true

# General Settings
raw = false
experimental = false
plugin_autoupdate_last_check_duration = "1d"
log_level = "warn"
activate_aggressive = true
cargo.binstall = true

# Status messages (minimal output)
status = { missing_tools = "if_other_versions_installed", show_env = false, show_tools = false }
gpg_verify = false

# ==============================================================================
# ENVIRONMENT VARIABLES
# ==============================================================================
[env]
PYTHONUNBUFFERED = "1"
UV_FROZEN = "false"
# Secrets loaded on-demand: eval "$(sops -d ~/.local/share/secrets/.env)"
# Saves ~23ms per shell startup (encrypted files can't be parsed as dotenv)

# ==============================================================================
# CORE RUNTIMES
# ==============================================================================
[tools]
node = "lts"
python = "latest"

# ==============================================================================
# DEVELOPMENT TOOLS (Pinned for reproducibility)
# ==============================================================================
# Formatters & Linters
pre-commit = "3.5.0"
prettier = "3.8.1"
shellcheck = "latest"

# ==============================================================================
# NODE.JS UTILITIES
# ==============================================================================
"npm:npm-check" = "latest"
"npm:npkill" = "latest"
"npm:markdownlint-cli" = "latest"
"npm:resumed" = "latest"
"npm:jsonresume-theme-even" = "latest"
"npm:repomix" = "latest"

# AI/MCP Tools
"npm:cline" = "latest"
"npm:@google/jules" = "latest"
"npm:@google/gemini-cli" = "latest"
"npm:@motesoftware/nanocoder" = "latest"
"npm:@pimzino/agentic-tools-mcp" = "latest"

# ==============================================================================
# PYTHON UTILITIES (pipx backend with uvx)
# ==============================================================================
"pipx:basic-memory" = "latest"
"pipx:gallery-dl" = "latest"
"pipx:git-filter-repo" = "latest"
"pipx:khard" = "latest"
"pipx:mac-cleanup" = "latest"
"pipx:osxmetadata" = "latest"
"pipx:osxphotos" = "latest"
"pipx:pygments" = "2.17.2"
"pipx:speedtest-cli" = "latest"
"pipx:yt-dlp" = "latest"
"pipx:twine" = "6.2.0"
"pipx:pptx2md" = "latest"
"pipx:scenedetect" = "latest"
"pipx:docling" = "latest"

# ==============================================================================
# RUST/CARGO UTILITIES
# ==============================================================================
# XDG-compliant cargo home: $HOME/.config/cargo
rust = { version = "stable", cargo_home = "$HOME/.config/cargo" }

"cargo:cargo-binstall" = "latest"
"cargo:cargo-update" = "latest"
"cargo:cargo-cache" = "latest"
"cargo:ripgrep" = "latest"
"cargo:fd-find" = "latest"
"cargo:bat" = "latest"
"cargo:eza" = "latest"
"cargo:git-delta" = "latest"
"cargo:navi" = "latest"
"cargo:sd" = "latest"
"cargo:procs" = "latest"
"cargo:zoxide" = "latest"
"cargo:starship" = "latest"
"cargo:imessage-exporter" = "latest"

# ==============================================================================
# AQUA TOOLS
# ==============================================================================
"aqua:watchexec/watchexec" = "latest"

# ==============================================================================
# HOOKS
# ==============================================================================
[hooks]
preinstall = 'echo "[mise] Installing $MISE_TOOL_NAME v$MISE_TOOL_VERSION"'
postinstall = [
  'echo "[mise] Installed $MISE_TOOL_NAME v$MISE_TOOL_VERSION"',
  '[ -f "$XDG_CONFIG_HOME/mise/hooks/mise-validate.sh" ] && zsh "$XDG_CONFIG_HOME/mise/hooks/mise-validate.sh"',
]

# ==============================================================================
# TASKS
# ==============================================================================
[tasks]
dots-validate = { run = "mise doctor && zsh $XDG_CONFIG_HOME/mise/hooks/mise-validate.sh", description = "Validate mise configuration and tool health" }
dots-update = { run = "mise install && mise doctor", description = "Update all tools" }
watch-config = { run = "watchexec -w $XDG_CONFIG_HOME/mise 'mise run dots-validate'", description = "Watch mise config and auto-validate (requires watchexec)" }
