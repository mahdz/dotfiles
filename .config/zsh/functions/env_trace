#!/bin/zsh

# function env_trace {
    # Trace the origin of environment variables across zsh config files
    # Usage: env_trace VAR_NAME

    local var_name="$1"
    echo "=== Tracing $var_name ==="

    # Check current value
    echo "Current: ${(P)var_name}"

    # Check all possible sources
    for file in /etc/zshenv ~/.zshenv /etc/zprofile /etc/zshrc $ZDOTDIR/.zshenv $XDG_CONFIG_HOME/shellrc $ZDOTDIR/.zshrc; do
        if [[ -f "$file" ]] && grep -q "$var_name" "$file"; then
            echo "Found in: $file"
            grep -n "$var_name" "$file"
        fi
    done

    # Check process parent
    echo "Parent PID: $PPID"
    ps -p $PPID -o command= | head -1
# }
env_trace "$@"
